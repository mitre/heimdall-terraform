##################################################################################
#
#   Conformance Pack:
#     IL5 critical controls for 800-53 rev 4
#
#   See Parameters section for names and descriptions of required parameters.
#
##################################################################################

# NOTICE:
#   Some controls have been sourced from:
#   https://github.com/awslabs/aws-config-rules


Parameters:

Resources:
  # AC-2
  # https://nvd.nist.gov/800-53/Rev4/control/AC-2
    ConfigRuleName: secretsmanager-scheduled-rotation-success-check
    ConfigRuleName: iam-user-group-membership-check
    ConfigRuleName: iam-password-policy
    ConfigRuleName: access-keys-rotated
    ConfigRuleName: iam-user-unused-credentials-check
    ConfigRuleName: guardduty-enabled-centralized
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: cloud-trail-cloud-watch-logs-enabled
    ConfigRuleName: cloudtrail-enabled
    ConfigRuleName: multi-region-cloudtrail-enabled
    ConfigRuleName: rds-logging-enabled
    ConfigRuleName: cloudwatch-alarm-action-check
    ConfigRuleName: redshift-cluster-configuration-check
    ConfigRuleName: iam-root-access-key-check
    ConfigRuleName: s3-bucket-logging-enabled
    ConfigRuleName: cloudtrail-s3-dataevents-enabled
    ConfigRuleName: root-account-mfa-enabled # Not present in managed rules! see iam-user-mfa-enabled
    ConfigRuleName: emr-kerberos-enabled
    ConfigRuleName: iam-group-has-users-check
    ConfigRuleName: iam-policy-no-statements-with-admin-access
    ConfigRuleName: iam-user-no-policies-check

  # AC-3
  # https://nvd.nist.gov/800-53/Rev4/control/AC-3
    ConfigRuleName: s3-bucket-public-write-prohibited
    ConfigRuleName: iam-user-no-policies-check
    ConfigRuleName: iam-user-unused-credentials-check
    ConfigRuleName: lambda-function-public-access-prohibited
    ConfigRuleName: rds-snapshots-public-prohibited
    ConfigRuleName: redshift-cluster-public-access-check
    ConfigRuleName: s3-bucket-policy-grantee-check
    ConfigRuleName: iam-user-group-membership-check
    ConfigRuleName: s3-account-level-public-access-blocks
    ConfigRuleName: iam-root-access-key-check
    ConfigRuleName: dms-replication-not-public
    ConfigRuleName: ebs-snapshot-public-restorable-check
    ConfigRuleName: emr-kerberos-enabled
    ConfigRuleName: iam-group-has-users-check
    ConfigRuleName: iam-policy-no-statements-with-admin-access
    ConfigRuleName: sagemaker-notebook-no-direct-internet-access

  # AC-6(1)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-6

  # AC-6(10)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-6
    ConfigRuleName: iam-root-access-key-check

  # AC-7
  # https://nvd.nist.gov/800-53/Rev4/control/AC-7

  # AC-12
  # https://nvd.nist.gov/800-53/Rev4/control/AC-12

  # AC-12(1)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-12

  # AC-17(1)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-17
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: guardduty-enabled-centralized

  # AC-17(2)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-17
    ConfigRuleName: alb-http-to-https-redirection-check
    ConfigRuleName: redshift-require-tls-ssl
    ConfigRuleName: acm-certificate-expiration-check
    ConfigRuleName: s3-bucket-ssl-requests-only
    ConfigRuleName: elb-acm-certificate-required
    ConfigRuleName: alb-http-drop-invalid-header-enabled
    ConfigRuleName: elb-tls-https-listeners-only

  # AC-17(3)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-17
    ConfigRuleName: internet-gateway-authorized-vpc-only

  # AC-17(6)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-17

  # AC-19(5)
  # https://nvd.nist.gov/800-53/Rev4/control/AC-19

  # AU-6(1)
  # https://nvd.nist.gov/800-53/Rev4/control/AU-6

  # AU-9
  # https://nvd.nist.gov/800-53/Rev4/control/AU-9
    ConfigRuleName: cloud-trail-encryption-enabled
    ConfigRuleName: cloudwatch-log-group-encrypted

  # AU-10
  # https://nvd.nist.gov/800-53/Rev4/control/AU-10

  # CM-5
  # https://nvd.nist.gov/800-53/Rev4/control/CM-5

  # CM-5(1)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-5

  # CM-5(6)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-5

  # CM-6
  # https://nvd.nist.gov/800-53/Rev4/control/CM-6

  # CM-6(1)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-6

  # CM-7
  # https://nvd.nist.gov/800-53/Rev4/control/CM-7
    ConfigRuleName: ec2-instance-managed-by-systems-manager
    ConfigRuleName: ec2-managedinstance-association-compliance-status-check

  # CM-7(1)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-7

  # CM-8(3)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-8
    ConfigRuleName: ec2-instance-managed-by-systems-manager
    ConfigRuleName: ec2-managedinstance-association-compliance-status-check
    ConfigRuleName: ec2-managedinstance-patch-compliance-status-check

  # CM-11(2)
  # https://nvd.nist.gov/800-53/Rev4/control/CM-11

  # IA-2
  # https://nvd.nist.gov/800-53/Rev4/control/IA-2
    ConfigRuleName: iam-password-policy

  # IA-5
  # https://nvd.nist.gov/800-53/Rev4/control/IA-5

  # IR-4
  # https://nvd.nist.gov/800-53/Rev4/control/IR-4

  # IR-4(4)
  # https://nvd.nist.gov/800-53/Rev4/control/IR-4

  # IR-4(6)
  # https://nvd.nist.gov/800-53/Rev4/control/IR-4

  # IR-6
  # https://nvd.nist.gov/800-53/Rev4/control/IR-6

  # IR-8
  # https://nvd.nist.gov/800-53/Rev4/control/IR-8

  # IR-9
  # https://nvd.nist.gov/800-53/Rev4/control/IR-9

  # RA-5
  # https://nvd.nist.gov/800-53/Rev4/control/RA-5

  # SC-2
  # https://nvd.nist.gov/800-53/Rev4/control/SC-2
    ConfigRuleName: iam-group-has-users-check
    ConfigRuleName: iam-policy-no-statements-with-admin-access

  # SC-7
  # https://nvd.nist.gov/800-53/Rev4/control/SC-7
    ConfigRuleName: ec2-instance-no-public-ip
    ConfigRuleName: s3-bucket-ssl-requests-only
    ConfigRuleName: redshift-require-tls-ssl
    ConfigRuleName: elb-acm-certificate-required
    ConfigRuleName: alb-http-to-https-redirection-check
    ConfigRuleName: elb-tls-https-listeners-only
    ConfigRuleName: wafv2-logging-enabled
    ConfigRuleName: ec2-instances-in-vpc
    ConfigRuleName: internet-gateway-authorized-vpc-only
    ConfigRuleName: dms-replication-not-public
    ConfigRuleName: ebs-snapshot-public-restorable-check
    ConfigRuleName: elasticsearch-in-vpc-only
    ConfigRuleName: emr-master-no-public-ip
    ConfigRuleName: restricted-ssh
    ConfigRuleName: lambda-function-public-access-prohibited
    ConfigRuleName: lambda-inside-vpc
    ConfigRuleName: rds-instance-public-access-check
    ConfigRuleName: rds-snapshots-public-prohibited
    ConfigRuleName: redshift-cluster-public-access-check
    ConfigRuleName: restricted-common-ports
    ConfigRuleName: s3-bucket-public-read-prohibited
    ConfigRuleName: s3-bucket-public-write-prohibited
    ConfigRuleName: sagemaker-notebook-no-direct-internet-access
    ConfigRuleName: vpc-default-security-group-closed
    ConfigRuleName: alb-waf-enabled
    ConfigRuleName: s3-bucket-policy-grantee-check
    ConfigRuleName: s3-account-level-public-access-blocks
    ConfigRuleName: vpc-sg-open-only-to-authorized-ports
    ConfigRuleName: alb-http-drop-invalid-header-enabled
    ConfigRuleName: elasticsearch-node-to-node-encryption-check

  # SC-7(5)
  # https://nvd.nist.gov/800-53/Rev4/control/SC-7

  # SC-8
  # https://nvd.nist.gov/800-53/Rev4/control/SC-8
    ConfigRuleName: alb-http-to-https-redirection-check
    ConfigRuleName: alb-http-drop-invalid-header-enabled
    ConfigRuleName: elasticsearch-node-to-node-encryption-check
    ConfigRuleName: elb-tls-https-listeners-only
    ConfigRuleName: redshift-require-tls-ssl
    ConfigRuleName: s3-bucket-ssl-requests-only
    ConfigRuleName: elb-acm-certificate-required

  # SC-10
  # https://nvd.nist.gov/800-53/Rev4/control/SC-10

  # SC-12
  # https://nvd.nist.gov/800-53/Rev4/control/SC-12

  # SC-23
  # https://nvd.nist.gov/800-53/Rev4/control/SC-21
    ConfigRuleName: alb-http-to-https-redirection-check
    ConfigRuleName: alb-http-drop-invalid-header-enabled
    ConfigRuleName: elb-tls-https-listeners-only

  # SC-23(3)
  # https://nvd.nist.gov/800-53/Rev4/control/SC-23

  # SI-3
  # https://nvd.nist.gov/800-53/Rev4/control/SI-3

  # SI-4
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
    ConfigRuleName: guardduty-enabled-centralized
    ConfigRuleName: guardduty-non-archived-findings
    ConfigRuleName: alb-waf-enabled
    ConfigRuleName: wafv2-logging-enabled
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: cloudwatch-alarm-action-check
    ConfigRuleName: cloud-trail-cloud-watch-logs-enabled
    ConfigRuleName: ec2-instance-detailed-monitoring-enabled

  # SI-4(1)
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
    ConfigRuleName: guardduty-enabled-centralized

  # SI-4(2)
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
    ConfigRuleName: guardduty-enabled-centralized
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: cloudwatch-alarm-action-check
    ConfigRuleName: cloud-trail-cloud-watch-logs-enabled
    ConfigRuleName: ec2-instance-detailed-monitoring-enabled

  # SI-4(4)
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
    ConfigRuleName: guardduty-enabled-centralized
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: cloudwatch-alarm-action-check
    ConfigRuleName: cloud-trail-cloud-watch-logs-enabled

  # SI-4(5)
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
    ConfigRuleName: guardduty-enabled-centralized
    ConfigRuleName: securityhub-enabled
    ConfigRuleName: cloudwatch-alarm-action-check
    ConfigRuleName: cloud-trail-cloud-watch-logs-enabled

  # SI-4(12)
  # https://nvd.nist.gov/800-53/Rev4/control/SI-4
