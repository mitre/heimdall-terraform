{
  "Version": "1.0",
  "Parameters": {
    "RuleName": "AC-03_S3_Bucket_Public_Write_Prohibited",
    "Description": "Checks that your Amazon S3 buckets do not allow public write access. The rule checks the Block Public Access settings, the bucket policy, and the bucket access control list (ACL).",
    "SourceRuntime": null,
    "CodeKey": null,
    "InputParameters": "{}",
    "OptionalParameters": "{}",
    "SourceEvents": "AWS::S3::Bucket",
    "SourceIdentifier": "S3_BUCKET_PUBLIC_WRITE_PROHIBITED",
    "Remediation": {
      "Automatic": true,
      "ConfigRuleName": "AC-03_S3_Bucket_Public_Write_Prohibited",
      "MaximumAutomaticAttempts": "10",
      "RetryAttemptSeconds": "600",
      "Parameters": {
        "AutomationAssumeRole": {
          "StaticValue": {
            "Values": [  
              { "Fn::Sub": "arn:aws-us-gov:iam::${AWS::AccountId}:role/Config_Remediation_Role-S3_Bucket_Public_Write_Prohibited" }
            ]
          }
        },
        "S3BucketName": {
          "ResourceValue": {
            "Value": "RESOURCE_ID"
          }
        }
      },
      "ExecutionControls": {
        "SsmControls": {
          "ConcurrentExecutionRatePercentage": "10",
          "ErrorPercentage": "10"
        }
      },
      "ResourceType": "AWS::S3::Bucket",
      "TargetId": "AWS-DisableS3BucketPublicReadWrite",
      "TargetType": "SSM_DOCUMENT",
      "TargetVersion": "1"
    }
  },
  "Tags": "[{\"Key\": \"TestType\", \"Value\": \"AWS Managed\"}, {\"Key\": \"CloudResource\", \"Value\": \"S3\"}, {\"Key\": \"Category\", \"Value\": \"Not Inherited\"}, {\"Key\": \"Responsibility\", \"Value\": \"USNORTHCOM\"}, {\"Key\": \"ValidationSteps\", \"Value\": \"-\"}, {\"Key\": \"USNORTHCOMValidated\", \"Value\": \"-\"}]"
}